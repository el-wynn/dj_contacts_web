{
    "version": "1.0",
    "rules": [
      {
        "name": "oauth-token-leak-prevention",
        "action": "block",
        "description": "Prevent exposure of OAuth tokens in URLs",
        "conditions": [
          {
            "target": "uri",
            "operator": "contains",
            "value": "access_token="
          }
        ]
      },

      {
        "name": "api-rate-limit",
        "action": "block",
        "description": "Limit API calls from single IP",
        "rateLimit": {
          "requestsPerMinute": 100,
          "burst": 50
        }
      },

      {
        "name": "sql-injection-protection",
        "action": "block",
        "description": "Block SQL injection attempts",
        "conditions": [
          {
            "target": "all",
            "operator": "regex",
            "value": "(?i)(\\b(union|select|drop|insert|update|delete)\\b|'\\s*or\\s*[0-9]+=[0-9]+)"
          }
        ]
      },
  
      {
        "name": "xss-protection",
        "action": "block",
        "description": "Block cross-site scripting",
        "conditions": [
          {
            "target": "all",
            "operator": "regex",
            "value": "(<script|javascript:|onload=|onerror=)"
          }
        ]
      },
  
      {
        "name": "invalid-api-path",
        "action": "block",
        "description": "Prevent API directory traversal",
        "conditions": [
          {
            "target": "uri",
            "operator": "regex",
            "value": "\\.\\.(/|%2f)"
          }
        ]
      }
    ]
  }